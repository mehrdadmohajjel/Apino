@using Apino.Application.Dtos
@using Apino.Application.Dtos.Shop
@model List<ProductItemViewModel>

<div class="row g-4">
    @if (Model != null && Model.Any())
    {
        foreach (var item in Model)
        {
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
                <div class="card h-100 shadow-sm border-0">

                    <!-- Product Image -->
                    <div class="ratio ratio-4x3">
                        <img src="/images/products/@item.ImageUrl"
                             class="card-img-top img-fluid"
                             alt="@item.Title"
                             onerror="this.src='/images/no-image.png'" />
                    </div>

                    <!-- Card Body -->
                    <div class="card-body d-flex flex-column">

                        <h6 class="card-title text-truncate" title="@item.Title">
                            @item.Title
                        </h6>

                        <div class="mb-2">
                            <span class="fw-bold text-success">
                                @item.Price.ToString("N0") تومان
                            </span>
                        </div>

                        <!-- Stock -->
                        <div class="mb-3">
                            @if (item.Stock > 0)
                            {
                                <span class="badge bg-success">
                                    موجودی: @item.Stock
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-danger">
                                    ناموجود
                                </span>
                            }
                        </div>

                        <!-- Action -->
                        <div class="mt-auto">
                            <button type="button"
                                    class="btn btn-primary w-100 add-to-cart-btn"
                                    data-id="@item.Id"
                                    data-stock="@item.Stock"
                                    data-payatplace="@item.PayAtPlace"
                                    @(item.Stock <= 0 ? "disabled" : "")>
                                <i class="bi bi-cart-plus ms-1"></i>
                                رزرو / افزودن به سبد
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="col-12 text-center py-5">
            <div class="alert alert-warning">
                محصولی برای نمایش وجود ندارد
            </div>
        </div>
    }
</div>
